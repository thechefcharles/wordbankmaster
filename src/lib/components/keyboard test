<script>
  import { onMount } from 'svelte';
  import {
    gameStore,
    selectLetter,
    inputGuessLetter,
    confirmPurchase,
    submitGuess,
    deleteGuessLetter,
    enterGuessMode,
    letterCosts
  } from '$lib/stores/GameStore.js';

  // QWERTY rows
  const row1 = ['Q','W','E','R','T','Y','U','I','O','P'];
  const row2 = ['A','S','D','F','G','H','J','K','L'];
  const row3 = ['Z','X','C','V','B','N','M'];

  // Click logic depends on gameState (guess vs purchase)
  function handleLetterClick(letter) {
    if ($gameStore.gameState === 'guess_mode') {
      inputGuessLetter(letter);
    } else {
      selectLetter(letter);
    }
  }

  // The rest of your existing logic ...
  // e.g. guessComplete, handleKeyDown, onMount for event listeners, etc.

</script>

<!-- Keyboard Layout -->
<div class="keyboard-container">
  <!-- ... existing row 1 and row 2 code ... -->

  <!-- Row 3 -->
  <div class="keyboard-row">
    {#each row3 as letter}
      <!-- Each letter button -->
      <button
        class="key { /* (your existing conditional classes) */ }"
        on:click={() => handleLetterClick(letter)}
      >
        <div class="letter">{letter}</div>
        <div class="price">${letterCosts[letter]}</div>
      </button>
    {/each}

    <!-- Enter Button with .shake class applied conditionally -->
    <button
      class="key enter-button {shakeEnter ? 'shake' : ''} 
        { /* (other conditional classes like 'submit-ready') */ }"
      on:click={() => {
        // normal click logic for Enter
        // e.g. confirmPurchase() or submitGuess(), plus any logic you already have
        if ($gameStore.gameState === 'guess_mode') {
          // ...
        } else {
          confirmPurchase();
        }
      }}
    >
      <div class="letter">Enter</div>
    </button>
  </div>
</div>

<style>
  /* ... your existing styles ... */

  /* Example Shake Animation */
  @keyframes shake {
    0%   { transform: translateX(0); }
    10%  { transform: translateX(-4px); }
    20%  { transform: translateX(4px); }
    30%  { transform: translateX(-4px); }
    40%  { transform: translateX(4px); }
    50%  { transform: translateX(-4px); }
    60%  { transform: translateX(4px); }
    70%  { transform: translateX(-4px); }
    80%  { transform: translateX(4px); }
    90%  { transform: translateX(-2px); }
    100% { transform: translateX(0); }
  }

  /* Apply the animation when .shake is present */
  .shake {
    animation: shake 0.4s ease-in-out;
  }
</style>
